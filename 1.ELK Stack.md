

# âœ… ELK Stack Architecture

+--------------------+       +-------------------+
| Windows 10 Agent   | --->  |                   |
| Winlogbeat         |       |                   |
+--------------------+       |                   |
                             |    ELK Server      |
+--------------------+       |  (Ubuntu 22.04)    |
| Kali Linux Agent   | --->  |                   |
| Filebeat / Auditd  |       |                   |
+--------------------+       +-------------------+
                                   |    |
                                   |    +--> Kibana (Web GUI)
                                   |
                              Elasticsearch (Storage)
                                   |
                               Logstash (Parsing)



---

## ðŸ§± COMPONENTS AND SETUP

### 1. ELK Server: Ubuntu 22.04

Install and configure Elasticsearch, Logstash, and Kibana.

#### A. Prerequisites:

``` bash
sudo apt update
sudo apt install apt-transport-https openjdk-17-jdk wget curl -y
```

#### B. Add Elastic Repo:

``` bash
wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -
echo "deb https://artifacts.elastic.co/packages/8.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-8.x.list
sudo apt update
```

#### C. Install ELK Components:

``` bash
sudo apt install elasticsearch kibana logstash -y
```

#### D. Configure and Enable Services:

##### Elasticsearch:

``` bash
sudo nano /etc/elasticsearch/elasticsearch.yml
# Add or modify:
network.host: 0.0.0.0
http.port: 9200
# Save & exit

sudo systemctl enable elasticsearch
sudo systemctl start elasticsearch
```

##### Kibana:

``` bash
sudo nano /etc/kibana/kibana.yml
# Modify:
server.host: "0.0.0.0"
elasticsearch.hosts: ["http://localhost:9200"]
# Save & exit

sudo systemctl enable kibana
sudo systemctl start kibana
```

##### Logstash:

Configure once Filebeat/Winlogbeat input configs are created.

------------------------------------------------------------------------

### 2. Kali Linux Agent

Install and configure Filebeat (or Auditbeat for audit logs).

``` bash
# Add Elastic repo
curl -fsSL https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -
echo "deb https://artifacts.elastic.co/packages/8.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-8.x.list
sudo apt update

# Install Filebeat
sudo apt install filebeat -y

# Configure output to Logstash
sudo nano /etc/filebeat/filebeat.yml
```

In the config file:

``` yaml
output.elasticsearch:
  enabled: false

output.logstash:
  hosts: ["<elk-server-ip>:5044"]
```

Then run:

``` bash
sudo systemctl enable filebeat
sudo systemctl start filebeat
```

------------------------------------------------------------------------

### 3. Windows 10 Agent

#### A. Download Winlogbeat:

```
<https://www.elastic.co/downloads/beats/winlogbeat
```


#### B. Extract and configure `winlogbeat.yml`:

``` yaml
output.logstash:
  hosts: ["<elk-server-ip>:5044"]
```

#### C. Install as a service:

``` powershell
cd 'C:\Program Files\Winlogbeat'
.\install-service-winlogbeat.ps1
Start-Service winlogbeat
```

------------------------------------------------------------------------

### 4. Logstash Configuration (on ELK Server)

``` bash
sudo nano /etc/logstash/conf.d/beats-input.conf
```

Config file content:

``` conf
input {
  beats {
    port => 5044
  }
}

output {
  elasticsearch {
    hosts => ["http://localhost:9200"]
    index => "%{[@metadata][beat]}-%{+YYYY.MM.dd}"
  }
}
```

Then enable Logstash:

``` bash
sudo systemctl enable logstash
sudo systemctl restart logstash
```

------------------------------------------------------------------------

### 5. Firewall Ports

Ensure these ports are open: - `9200` (Elasticsearch) - `5601`
(Kibana) - `5044` (Logstash)

------------------------------------------------------------------------

### 6. Kibana Access

Visit in browser:

    http://<elk-server-ip>:5601

Dashboards for Filebeat and Winlogbeat will appear.

------------------------------------------------------------------------

## âœ… Optional Beats

-   **Auditbeat** -- Linux audit logs
-   **Packetbeat** -- Network monitoring
-   **Metricbeat** -- System and service metrics




